imports:
#Compute
- path: compute/managed-instance-group.jinja
#Network
#- path: networking/loadbalancer.jinja
- path: networking/firewall.jinja
- path: networking/network.jinja
- path: networking/subnetwork.jinja
#Storage
- path: storage/bucket.jinja
#- path: storage/sql.jinja

resources:
- name: deploy-instance-group
  type: compute/managed-instance-group.jinja
  properties:
    image: projects/ubuntu-os-cloud/global/images/family/ubuntu-2004-lts
    region: europe-west4
    zone: europe-west4-a
    subnet: $(ref.custom-subnet-1.selfLink)

- name: company-storage-bucket
  type: storage/bucket.jinja

- name: custom-network
  type: networking/network.jinja

- name: custom-subnet-1
  type: networking/subnetwork.jinja
  properties:
    ipCidrRange: 10.240.0.0/24
    network: $(ref.custom-network.selfLink)
    region: europe-west4

- name: http-ssh
  type: networking/firewall.jinja
  properties:
    network: $(ref.custom-network.selfLink)
    IPProtocol: TCP
    port: 80, 22

- name: custom-firewall-allow-ssh
  type: networking/firewall.jinja
  properties:
    network: $(ref.custom-network.selfLink)
    IPProtocol: TCP
    port: 22

#- name: sql
#  type: storage/sql.jinja
#  properties:
#    tier: db-g1-small